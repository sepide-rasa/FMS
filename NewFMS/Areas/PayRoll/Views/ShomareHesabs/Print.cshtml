@using Ext.Net.MVC;

@(
 Html.X().Window()
    .Height(500)
    .ID("ShomareHesabPrint")
    .Maximized(true)
    .Modal(true)
    .Width(1200)
    .Title("پیش نمایش")
    .Closable(true)
    .CloseAction(Ext.Net.CloseAction.Destroy)
    .Listeners(l => l.AfterRender.Handler = "LoadReportSh();")
    .Html("<center><object class='se-pre-con' style='width: 100%;height: 100%;border: 1px solid #ccc;' type='application/pdf' data='/PayRoll/ShomareHesabs/GeneratePDF?BankId="
            + ViewBag.BankId + "&TypeHesabId=" + ViewBag.TypeHesabId + "&OrganId=" + ViewBag.OrganId + "'></object></center>")
)

<script>
    function LoadReportSh() {
        var a = $('object');
        var h = App.ShomareHesabPrint.height;
        a.height(h-35);
    }
</script>
