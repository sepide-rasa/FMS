@using Ext.Net.MVC;

@(
 Html.X().Window().Height(560).Width(1000)
    .Title("پیش نمایش")
    .ID("PrintrptBime")
    .AutoScroll(true)
    .Maximized(true)
    .Modal(true)
    .Closable(true)
    .Listeners(l => l.AfterRender.Handler = "LoadReportBime();")
    .CloseAction(Ext.Net.CloseAction.Destroy)
    .Html("<center><object class='se-pre-con' style='width:  100%;height: 100%;border: 1px solid #ccc;' type='application/pdf' data='/PayRoll/SpecialOperation/GeneratePDFrptBime?Year="
        + @ViewBag.Year + "&Month=" + @ViewBag.Month + "&NobatePardakht=" + @ViewBag.NobatePardakht //+ "&KargahId=" + @ViewBag.KargahId
         + "&FieldName=" + @ViewBag.FieldName + "&sh_List=" + @ViewBag.sh_List + "'></object></center>")
)

<script>
    function LoadReportBime() {
        var a = $('object');
        var h = App.PrintrptBime.height;
        a.height(h-35);
    }
</script>