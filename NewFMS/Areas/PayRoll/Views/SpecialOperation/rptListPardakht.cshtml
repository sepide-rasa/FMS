@using Ext.Net.MVC;

@(
 Html.X().Window().Height(560).Width(1000)
    .Title("پیش نمایش")
    .ID("PrintrptListPardakhti")
    .AutoScroll(true)
    .Modal(true)
    .Closable(true)
    .Maximized(true)
    .Listeners(l => l.AfterRender.Handler = "LoadReportListPardakhti();")
    .CloseAction(Ext.Net.CloseAction.Destroy)
    .Html("<center><object class='se-pre-con' style='width: 100%;height: 100%;border: 1px solid #ccc;' type='application/pdf' data='/PayRoll/SpecialOperation/GeneratePDFListPardakhti?FieldName=" + @ViewBag.FieldName + "&MarhalePardakht=" + @ViewBag.MarhalePardakht + "&NobatePardakht=" + @ViewBag.NobatePardakht + "&Month=" + @ViewBag.Month + "&Year=" + @ViewBag.Year + "'></object></center>")
)

<script>
    function LoadReportListPardakhti() {
        var a = $('object');
        var h = App.PrintrptListPardakhti.height;
        a.height(h-35);
    }
</script>