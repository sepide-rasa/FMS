@using Ext.Net.MVC
@using Hogaf.ExtNet.UX
@using Ext.Net;
@{

    var X = Html.X();
}
<script src="~/Scripts/accounting.js"></script>
<script>
</script>

@(X.Panel().Title("خروجی اکسل").Border(false)
                .ID("Excel")
            .Closable(true)
            .AutoScroll(true)
            .CloseAction(Ext.Net.CloseAction.Destroy)

            .Items(
                X.Panel().Border(false)
                .Border(false)
                .AutoScroll(true)
                .Items(
                         X.TabPanel().ID("ExcelTab")
                    .AutoScroll(true).Border(false)
                    .Items(
                        X.Panel().ItemID("Panel")
                        .Layout(Ext.Net.LayoutType.Table)
                        .LayoutConfig(new Ext.Net.TableLayoutConfig { Columns = 4 })
                        .Title("")
                        .Defaults(new { Margin = 10 })
                        .Items(
                                X.Checkbox()
                            .ItemID("CheckedName")
                            .FieldLabel("نام").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedFamily")
                            .FieldLabel("نام خانوادگی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedFather")
                            .FieldLabel("نام پدر").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedJensiyat")
                            .FieldLabel("جنسیت").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedShomareShenasname")
                            .FieldLabel("شماره شناسنامه").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedTarikhTavalod")
                            .FieldLabel("تاریخ تولد").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedCity")
                            .FieldLabel("شهر محل صدور").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedAddres")
                            .FieldLabel("آدرس").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckeCodePosti")
                            .FieldLabel("کد پستی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedStatusEsargari")
                            .FieldLabel("وضعیت ایثارگری").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedShomarePersoneli")
                            .FieldLabel("شماره پرسنلی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedReshteTahsili")
                            .FieldLabel("رشته تحصیلی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedStatusNezamVazife")
                            .FieldLabel("وضعیت نظام وظیفه").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedOrganizationalPosts")
                            .FieldLabel("پست سازمانی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedRasteShoghli")
                            .FieldLabel("رسته شغلی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedReshteShoghli")
                            .FieldLabel("رشته شغلی").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedTarikhEstekhdam")
                            .FieldLabel("تاریخ استخدام").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedTabaghe")
                            .FieldLabel("طبقه").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedMeliyat")
                            .FieldLabel("ملیت").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedShMojavezEstekhdam")
                            .FieldLabel("شماره مجوز استخدام").LabelAlign(Ext.Net.LabelAlign.Top)

                            , X.Checkbox()
                            .ItemID("CheckedTMojavezEstekhdam")
                            .FieldLabel("تاریخ مجوز استخدام").LabelAlign(Ext.Net.LabelAlign.Top)

                        )
                            .TopBar(
                            Html.X().Toolbar()
                            .Items(
                                   X.Button().Text("خروجی اکسل").Icon(Ext.Net.Icon.ArrowRedo)
                                       .Listeners(de =>
                                    {
                                        de.Click.Handler = "CreatExcel()";
                                    })
                            )
                        )

                 )
            )
        )
)

<script type="text/javascript">
    function CreatExcel()
    {
        var CheckedName = App.ExcelTab.activeTab.queryById('CheckedName').getValue();
        var CheckedFamily = App.ExcelTab.activeTab.queryById('CheckedFamily').getValue();
        var CheckedFather = App.ExcelTab.activeTab.queryById('CheckedFather').getValue();
        var CheckedJensiyat = App.ExcelTab.activeTab.queryById('CheckedJensiyat').getValue();
        var CheckedShomareShenasname = App.ExcelTab.activeTab.queryById('CheckedShomareShenasname').getValue();
        var CheckedTarikhTavalod = App.ExcelTab.activeTab.queryById('CheckedTarikhTavalod').getValue();
        var CheckedCity = App.ExcelTab.activeTab.queryById('CheckedCity').getValue();
        var CheckedAddres = App.ExcelTab.activeTab.queryById('CheckedAddres').getValue();
        var CheckeCodePosti = App.ExcelTab.activeTab.queryById('CheckeCodePosti').getValue();
        var CheckedStatusEsargari = App.ExcelTab.activeTab.queryById('CheckedStatusEsargari').getValue();
        var CheckedShomarePersoneli = App.ExcelTab.activeTab.queryById('CheckedShomarePersoneli').getValue();
        var CheckedReshteTahsili = App.ExcelTab.activeTab.queryById('CheckedReshteTahsili').getValue();
        var CheckedStatusNezamVazife = App.ExcelTab.activeTab.queryById('CheckedStatusNezamVazife').getValue();
        var CheckedOrganizationalPosts = App.ExcelTab.activeTab.queryById('CheckedOrganizationalPosts').getValue();
        var CheckedRasteShoghli = App.ExcelTab.activeTab.queryById('CheckedRasteShoghli').getValue();
        var CheckedReshteShoghli = App.ExcelTab.activeTab.queryById('CheckedReshteShoghli').getValue();
        var CheckedTarikhEstekhdam = App.ExcelTab.activeTab.queryById('CheckedTarikhEstekhdam').getValue();
        var CheckedTabaghe = App.ExcelTab.activeTab.queryById('CheckedTabaghe').getValue();
        var CheckedMeliyat = App.ExcelTab.activeTab.queryById('CheckedMeliyat').getValue();
        var CheckedShMojavezEstekhdam = App.ExcelTab.activeTab.queryById('CheckedShMojavezEstekhdam').getValue();
        var CheckedTMojavezEstekhdam = App.ExcelTab.activeTab.queryById('CheckedTMojavezEstekhdam').getValue();
        var CheckedReshteShoghli = App.ExcelTab.activeTab.queryById('CheckedReshteShoghli').getValue();
        var Checked = "";
        if (CheckedName == true)
            Checked = Checked + "Name" + ";";
        if (CheckedFamily==true)
            Checked = Checked + "Family" + ";";
        if(CheckedFather==true)
            Checked = Checked + "Father" + ";";
        if(CheckedJensiyat==true)
            Checked = Checked + "Jensiyat" + ";";
        if (CheckedShomareShenasname == true)
            Checked = Checked + "ShomareShenasname" + ";";
        if (CheckedTarikhTavalod == true)
            Checked = Checked + "TarikhTavalod" + ";";
        if (CheckedCity == true)
            Checked = Checked + "City" + ";";
        if (CheckedAddres == true)
            Checked = Checked + "Addres" + ";";
        if (CheckeCodePosti == true)
            Checked = Checked + "CodePosti" + ";";
        if (CheckedStatusEsargari == true)
            Checked = Checked + "StatusEsargari" + ";";
        if (CheckedShomarePersoneli == true)
            Checked = Checked + "ShomarePersoneli" + ";";
        if (CheckedReshteTahsili == true)
            Checked = Checked + "ReshteTahsili" + ";";
        if (CheckedStatusNezamVazife == true)
            Checked = Checked + "StatusNezamVazife" + ";";
        if (CheckedOrganizationalPosts == true)
            Checked = Checked + "OrganizationalPosts" + ";";
        if (CheckedRasteShoghli == true)
            Checked = Checked + "RasteShoghli" + ";";
        if (CheckedReshteShoghli == true)
            Checked = Checked + "ReshteShoghli" + ";";
        if(CheckedTarikhEstekhdam==true)
            Checked = Checked + "TarikhEstekhdam" + ";";
        if (CheckedTabaghe == true)
            Checked = Checked + "Tabaghe" + ";";
        if(CheckedMeliyat==true)
            Checked = Checked + "Meliyat" + ";";
        if (CheckedShMojavezEstekhdam == true)
            Checked = Checked + "ShMojavezEstekhdam" + ";";
        if (CheckedTMojavezEstekhdam == true)
            Checked = Checked + "TMojavezEstekhdam" + ";";
        window.location.href = '@Url.Content("~/Personeli/PersonalInfo/CreateExcel/")' + '?Checked=' + Checked;
    }
</script>